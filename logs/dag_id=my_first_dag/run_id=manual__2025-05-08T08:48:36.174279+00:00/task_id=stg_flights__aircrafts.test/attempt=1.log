{"timestamp":"2025-05-08T08:51:23.947067","level":"info","event":"DAG bundles loaded: dags-folder, example_dags","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-05-08T08:51:23.948640","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/dbt/my_first_dag.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-05-08T08:51:23.956939","level":"info","event":"Trying to parse the dbt project using dbt ls cache cosmos_cache__my_first_dag...","logger":"cosmos.dbt.graph"}
{"timestamp":"2025-05-08T08:51:23.959305","level":"info","event":"Secrets backends loaded for worker","count":1,"backend_classes":["EnvironmentVariablesBackend"],"logger":"supervisor"}
{"timestamp":"2025-05-08T08:51:26.974164","level":"warning","event":"The dbt project folder contains a symbolic link to a non-existent file: /opt/airflow/dags/dbt/.trunk/actions","logger":"cosmos.cache"}
{"timestamp":"2025-05-08T08:51:26.983705","level":"warning","event":"The dbt project folder contains a symbolic link to a non-existent file: /opt/airflow/dags/dbt/.trunk/logs","logger":"cosmos.cache"}
{"timestamp":"2025-05-08T08:51:26.986640","level":"warning","event":"The dbt project folder contains a symbolic link to a non-existent file: /opt/airflow/dags/dbt/.trunk/notifications","logger":"cosmos.cache"}
{"timestamp":"2025-05-08T08:51:26.988501","level":"warning","event":"The dbt project folder contains a symbolic link to a non-existent file: /opt/airflow/dags/dbt/.trunk/out","logger":"cosmos.cache"}
{"timestamp":"2025-05-08T08:51:26.990709","level":"warning","event":"The dbt project folder contains a symbolic link to a non-existent file: /opt/airflow/dags/dbt/.trunk/plugins/trunk","logger":"cosmos.cache"}
{"timestamp":"2025-05-08T08:51:26.993265","level":"warning","event":"The dbt project folder contains a symbolic link to a non-existent file: /opt/airflow/dags/dbt/.trunk/tools","logger":"cosmos.cache"}
{"timestamp":"2025-05-08T08:51:27.112792","level":"warning","event":"The dbt project folder contains a symbolic link to a non-existent file: /opt/airflow/dags/dbt/.venv/bin/python","logger":"cosmos.cache"}
{"timestamp":"2025-05-08T08:51:27.117225","level":"warning","event":"The dbt project folder contains a symbolic link to a non-existent file: /opt/airflow/dags/dbt/.venv/bin/python3","logger":"cosmos.cache"}
{"timestamp":"2025-05-08T08:51:27.118800","level":"warning","event":"The dbt project folder contains a symbolic link to a non-existent file: /opt/airflow/dags/dbt/.venv/bin/python3.13","logger":"cosmos.cache"}
{"timestamp":"2025-05-08T08:52:30.440750","level":"info","event":"Cosmos performance: time to calculate cache identifier cosmos_cache__my_first_dag for current version: 66.43915432201175","logger":"cosmos.cache"}
{"timestamp":"2025-05-08T08:52:30.443188","level":"info","event":"Cosmos performance [81b6b32c5700|772]: The cache size for cosmos_cache__my_first_dag is 2453","logger":"cosmos.dbt.graph"}
{"timestamp":"2025-05-08T08:52:30.445776","level":"info","event":"Cosmos performance: Cache hit for cosmos_cache__my_first_dag - ee3e89bc51bd781e21431365e7002704,1216c01535c4629822fc8b4e59102553","logger":"cosmos.dbt.graph"}
{"timestamp":"2025-05-08T08:52:30.471653","level":"info","event":"Total nodes: 2","logger":"cosmos.dbt.graph"}
{"timestamp":"2025-05-08T08:52:30.472122","level":"info","event":"Total filtered nodes: 2","logger":"cosmos.dbt.graph"}
{"timestamp":"2025-05-08T08:52:30.472344","level":"info","event":"Cosmos performance (my_first_dag) -  [81b6b32c5700|772]: It took 66.5s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE","logger":"cosmos.converter"}
{"timestamp":"2025-05-08T08:52:30.491532","level":"info","event":"Cosmos performance (my_first_dag) - [81b6b32c5700|772]: It took 0.0193s to build the Airflow DAG.","logger":"cosmos.converter"}
{"timestamp":"2025-05-08T08:52:30.492826","level":"warning","event":"/home/airflow/.local/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:\n  PydanticSerializationUnexpectedValue(Expected `str` - serialized value may not be as expected [input_value={'version': 'ee3e89bc51bd..., 'task_group_id': None}, input_type=dict])\n  return self.__pydantic_serializer__.to_python(\n","logger":"py.warnings"}
{"timestamp":"2025-05-08T08:52:30.585651Z","level":"info","event":"Task instance is in running state","chan":"stdout","logger":"task"}
{"timestamp":"2025-05-08T08:52:30.590418Z","level":"info","event":" Previous state of the Task instance: queued","chan":"stdout","logger":"task"}
{"timestamp":"2025-05-08T08:52:30.594243Z","level":"info","event":"Current task name:stg_flights__aircrafts.test","chan":"stdout","logger":"task"}
{"timestamp":"2025-05-08T08:52:30.597270Z","level":"info","event":"Dag name:my_first_dag","chan":"stdout","logger":"task"}
{"timestamp":"2025-05-08T08:52:33.492537","level":"info","event":"dbtRunner is available. Using dbtRunner for invoking dbt.","logger":"cosmos.operators.base"}
{"timestamp":"2025-05-08T08:52:33.494203","level":"info","event":"Cloning project to writable temp directory /tmp/tmp6pmd840f from /opt/airflow/dags/dbt","logger":"cosmos.operators.base"}
{"timestamp":"2025-05-08T08:52:33.501321","level":"info","event":"Partial parse is enabled and the latest partial parse file is /tmp/cosmos/my_first_dag/target/partial_parse.msgpack","logger":"cosmos.operators.base"}
{"timestamp":"2025-05-08T08:52:33.563129","level":"info","event":"Profile caching is enable.","logger":"cosmos.config"}
{"timestamp":"2025-05-08T08:52:33.565644","level":"info","event":"Secrets backends loaded for worker","count":1,"backend_classes":["EnvironmentVariablesBackend"],"logger":"supervisor"}
{"timestamp":"2025-05-08T08:52:33.604318","level":"info","event":"Connection Retrieved 'postgres_dbt'","logger":"airflow.hooks.base"}
{"timestamp":"2025-05-08T08:52:33.604674","level":"info","event":"Profile found in cache using profile: /tmp/cosmos/profile/5685f440b338e3a65841a90df244eacf377566740ec75f4ce3e77a914c55ffdd/profiles.yml.","logger":"cosmos.config"}
{"timestamp":"2025-05-08T08:52:33.612679","level":"info","event":"Trying to run dbtRunner with:\n ['deps', '--project-dir', '/tmp/tmp6pmd840f', '--profiles-dir', '/tmp/cosmos/profile/5685f440b338e3a65841a90df244eacf377566740ec75f4ce3e77a914c55ffdd', '--profile', 'default', '--target', 'dev']\n in /tmp/tmp6pmd840f","logger":"cosmos.dbt.runner"}
{"timestamp":"2025-05-08T08:52:33.713470Z","level":"info","event":"\u001b[0m08:52:33  Running with dbt=1.8.7","chan":"stdout","logger":"task"}
{"timestamp":"2025-05-08T08:52:35.566502Z","level":"info","event":"\u001b[0m08:52:35  Installing dbt-labs/dbt_utils","chan":"stdout","logger":"task"}
{"timestamp":"2025-05-08T08:52:36.161583Z","level":"info","event":"\u001b[0m08:52:36  Installed from version 1.3.0","chan":"stdout","logger":"task"}
{"timestamp":"2025-05-08T08:52:36.162824Z","level":"info","event":"\u001b[0m08:52:36  Up to date!","chan":"stdout","logger":"task"}
{"timestamp":"2025-05-08T08:52:36.164508Z","level":"info","event":"\u001b[0m08:52:36  Installing dbt-labs/codegen","chan":"stdout","logger":"task"}
{"timestamp":"2025-05-08T08:52:36.846271Z","level":"info","event":"\u001b[0m08:52:36  Installed from version 0.13.1","chan":"stdout","logger":"task"}
{"timestamp":"2025-05-08T08:52:36.848209Z","level":"info","event":"\u001b[0m08:52:36  Up to date!","chan":"stdout","logger":"task"}
{"timestamp":"2025-05-08T08:52:36.850443Z","level":"info","event":"\u001b[0m08:52:36  Installing Datavault-UK/automate_dv","chan":"stdout","logger":"task"}
{"timestamp":"2025-05-08T08:52:37.415055Z","level":"info","event":"\u001b[0m08:52:37  Installed from version 0.11.2","chan":"stdout","logger":"task"}
{"timestamp":"2025-05-08T08:52:37.416045Z","level":"info","event":"\u001b[0m08:52:37  Up to date!","chan":"stdout","logger":"task"}
{"timestamp":"2025-05-08T08:52:38.155804","level":"info","event":"Trying to run dbtRunner with:\n ['test', '--models', 'stg_flights__aircrafts', '--project-dir', '/tmp/tmp6pmd840f', '--profiles-dir', '/tmp/cosmos/profile/5685f440b338e3a65841a90df244eacf377566740ec75f4ce3e77a914c55ffdd', '--profile', 'default', '--target', 'dev']\n in /tmp/tmp6pmd840f","logger":"cosmos.dbt.runner"}
{"timestamp":"2025-05-08T08:52:38.186763Z","level":"info","event":"\u001b[0m08:52:38  Running with dbt=1.8.7","chan":"stdout","logger":"task"}
{"timestamp":"2025-05-08T08:52:38.526441Z","level":"info","event":"\u001b[0m08:52:38  Registered adapter: postgres=1.9.0","chan":"stdout","logger":"task"}
{"timestamp":"2025-05-08T08:52:40.680486Z","level":"info","event":"\u001b[0m08:52:40  Found 24 models, 5 snapshots, 10 analyses, 26 data tests, 3 seeds, 1 operation, 8 sources, 850 macros","chan":"stdout","logger":"task"}
{"timestamp":"2025-05-08T08:52:40.694230Z","level":"info","event":"\u001b[0m08:52:40","chan":"stdout","logger":"task"}
{"timestamp":"2025-05-08T08:52:41.031633Z","level":"info","event":"\u001b[0m08:52:41  Concurrency: 1 threads (target='dev')","chan":"stdout","logger":"task"}
{"timestamp":"2025-05-08T08:52:41.034181Z","level":"info","event":"\u001b[0m08:52:41","chan":"stdout","logger":"task"}
{"timestamp":"2025-05-08T08:52:41.046049Z","level":"info","event":"\u001b[0m08:52:41  1 of 1 START test relationships_stg_flights__seats_aircraft_code__aircraft_code__ref_stg_flights__aircrafts_  [RUN]","chan":"stdout","logger":"task"}
{"timestamp":"2025-05-08T08:52:41.170065Z","level":"info","event":"\u001b[0m08:52:41  1 of 1 ERROR relationships_stg_flights__seats_aircraft_code__aircraft_code__ref_stg_flights__aircrafts_  [\u001b[31mERROR\u001b[0m in 0.12s]","chan":"stdout","logger":"task"}
{"timestamp":"2025-05-08T08:52:41.214168Z","level":"info","event":"\u001b[0m08:52:41","chan":"stdout","logger":"task"}
{"timestamp":"2025-05-08T08:52:41.216153Z","level":"info","event":"\u001b[0m08:52:41  Running 1 on-run-end hook","chan":"stdout","logger":"task"}
{"timestamp":"2025-05-08T08:52:41.243750Z","level":"info","event":"\u001b[0m08:52:41  1 of 1 START hook: dbt_course_practice.on-run-end.0 ............................ [RUN]","chan":"stdout","logger":"task"}
{"timestamp":"2025-05-08T08:52:41.250059Z","level":"info","event":"\u001b[0m08:52:41  1 of 1 OK hook: dbt_course_practice.on-run-end.0 ............................... [\u001b[32mOK\u001b[0m in 0.00s]","chan":"stdout","logger":"task"}
{"timestamp":"2025-05-08T08:52:41.254623Z","level":"info","event":"\u001b[0m08:52:41","chan":"stdout","logger":"task"}
{"timestamp":"2025-05-08T08:52:41.258416Z","level":"info","event":"\u001b[0m08:52:41","chan":"stdout","logger":"task"}
{"timestamp":"2025-05-08T08:52:41.260357Z","level":"info","event":"\u001b[0m08:52:41  Finished running 1 test, 1 project hook in 0 hours 0 minutes and 0.55 seconds (0.55s).","chan":"stdout","logger":"task"}
{"timestamp":"2025-05-08T08:52:41.349587Z","level":"info","event":"\u001b[0m08:52:41","chan":"stdout","logger":"task"}
{"timestamp":"2025-05-08T08:52:41.352757Z","level":"info","event":"\u001b[0m08:52:41  \u001b[31mCompleted with 1 error and 0 warnings:\u001b[0m","chan":"stdout","logger":"task"}
{"timestamp":"2025-05-08T08:52:41.356282Z","level":"info","event":"\u001b[0m08:52:41","chan":"stdout","logger":"task"}
{"timestamp":"2025-05-08T08:52:41.358531Z","level":"info","event":"\u001b[0m08:52:41    Database Error in test relationships_stg_flights__seats_aircraft_code__aircraft_code__ref_stg_flights__aircrafts_ (models/staging/flights/_stg_fligths__models.yml)","chan":"stdout","logger":"task"}
{"timestamp":"2025-05-08T08:52:41.361559Z","level":"info","event":"  relation \"intermediate.stg_flights__seats\" does not exist","chan":"stdout","logger":"task"}
{"timestamp":"2025-05-08T08:52:41.365279Z","level":"info","event":"  LINE 13:     from \"dwh_flight\".\"intermediate\".\"stg_flights__seats\"","chan":"stdout","logger":"task"}
{"timestamp":"2025-05-08T08:52:41.368317Z","level":"info","event":"                    ^","chan":"stdout","logger":"task"}
{"timestamp":"2025-05-08T08:52:41.370719Z","level":"info","event":"  compiled code at target/run/dbt_course_practice/models/staging/flights/_stg_fligths__models.yml/relationships_stg_flights__sea_7c71c75ad15d9370b8d2701f9e66c9b6.sql","chan":"stdout","logger":"task"}
{"timestamp":"2025-05-08T08:52:41.373597Z","level":"info","event":"\u001b[0m08:52:41","chan":"stdout","logger":"task"}
{"timestamp":"2025-05-08T08:52:41.375281Z","level":"info","event":"\u001b[0m08:52:41  Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1","chan":"stdout","logger":"task"}
{"timestamp":"2025-05-08T08:52:42.117178","level":"warning","event":"\n                Airflow 3.0.0 Asset (Dataset) URIs validation rules changed and OpenLineage URIs (standard used by Cosmos) are no longer accepted.\n                Therefore, if using Cosmos with Airflow 3, the Airflow Asset (Dataset) URI is now <postgres://dbt-course-postgres:5432/dwh_flight/intermediate/stg_flights__seats>.\n                Before, with Airflow 2.x, the URI used to be <postgres://dbt-course-postgres:5432/dwh_flight.intermediate.stg_flights__seats>.\n                Please, change any DAGs that were scheduled using the old standard to the new one.\n                ","logger":"cosmos.operators.local"}
{"timestamp":"2025-05-08T08:52:42.315400","level":"info","event":"Inlets: [Asset(name='postgres://dbt-course-postgres:5432/dwh_flight/intermediate/stg_flights__seats', uri='postgres://dbt-course-postgres:5432/dwh_flight/intermediate/stg_flights__seats', group='asset', extra={}, watchers=[])]","logger":"cosmos.operators.base"}
{"timestamp":"2025-05-08T08:52:42.316369","level":"info","event":"Outlets: []","logger":"cosmos.operators.base"}
{"timestamp":"2025-05-08T08:52:42.316852","level":"info","event":"Assigning outlets with DatasetAlias in Airflow 3","logger":"cosmos.operators.local"}
{"timestamp":"2025-05-08T08:52:42.347614","level":"error","event":"Task failed with exception","logger":"task","error_detail":[{"exc_type":"CosmosDbtRunError","exc_value":"dbt invocation completed with errors: relationships_stg_flights__seats_aircraft_code__aircraft_code__ref_stg_flights__aircrafts_: Database Error in test relationships_stg_flights__seats_aircraft_code__aircraft_code__ref_stg_flights__aircrafts_ (models/staging/flights/_stg_fligths__models.yml)\n  relation \"intermediate.stg_flights__seats\" does not exist\n  LINE 13:     from \"dwh_flight\".\"intermediate\".\"stg_flights__seats\"\n                    ^\n  compiled code at target/run/dbt_course_practice/models/staging/flights/_stg_fligths__models.yml/relationships_stg_flights__sea_7c71c75ad15d9370b8d2701f9e66c9b6.sql","exc_notes":[],"syntax_error":null,"is_cause":false,"frames":[{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":825,"name":"run"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":1088,"name":"_execute_task"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/bases/operator.py","lineno":408,"name":"wrapper"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/cosmos/operators/local.py","lineno":1027,"name":"execute"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/cosmos/operators/local.py","lineno":790,"name":"build_and_run_cmd"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/cosmos/operators/local.py","lineno":594,"name":"run_command"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/cosmos/operators/local.py","lineno":244,"name":"handle_exception_dbt_runner"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/cosmos/dbt/runner.py","lineno":113,"name":"handle_exception_if_needed"}]}]}
