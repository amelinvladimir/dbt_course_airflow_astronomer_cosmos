{"timestamp":"2025-05-08T08:38:25.927308","level":"info","event":"DAG bundles loaded: dags-folder, example_dags","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-05-08T08:38:25.928671","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/dbt/my_first_dag.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-05-08T08:38:25.946586","level":"info","event":"Trying to parse the dbt project using dbt ls cache cosmos_cache__my_first_dag...","logger":"cosmos.dbt.graph"}
{"timestamp":"2025-05-08T08:38:25.951589","level":"info","event":"Secrets backends loaded for worker","count":1,"backend_classes":["EnvironmentVariablesBackend"],"logger":"supervisor"}
{"timestamp":"2025-05-08T08:38:27.605634","level":"warning","event":"The dbt project folder contains a symbolic link to a non-existent file: /opt/airflow/dags/dbt/.trunk/actions","logger":"cosmos.cache"}
{"timestamp":"2025-05-08T08:38:27.609731","level":"warning","event":"The dbt project folder contains a symbolic link to a non-existent file: /opt/airflow/dags/dbt/.trunk/logs","logger":"cosmos.cache"}
{"timestamp":"2025-05-08T08:38:27.610588","level":"warning","event":"The dbt project folder contains a symbolic link to a non-existent file: /opt/airflow/dags/dbt/.trunk/notifications","logger":"cosmos.cache"}
{"timestamp":"2025-05-08T08:38:27.611199","level":"warning","event":"The dbt project folder contains a symbolic link to a non-existent file: /opt/airflow/dags/dbt/.trunk/out","logger":"cosmos.cache"}
{"timestamp":"2025-05-08T08:38:27.611616","level":"warning","event":"The dbt project folder contains a symbolic link to a non-existent file: /opt/airflow/dags/dbt/.trunk/plugins/trunk","logger":"cosmos.cache"}
{"timestamp":"2025-05-08T08:38:27.612061","level":"warning","event":"The dbt project folder contains a symbolic link to a non-existent file: /opt/airflow/dags/dbt/.trunk/tools","logger":"cosmos.cache"}
{"timestamp":"2025-05-08T08:38:27.663173","level":"warning","event":"The dbt project folder contains a symbolic link to a non-existent file: /opt/airflow/dags/dbt/.venv/bin/python","logger":"cosmos.cache"}
{"timestamp":"2025-05-08T08:38:27.664747","level":"warning","event":"The dbt project folder contains a symbolic link to a non-existent file: /opt/airflow/dags/dbt/.venv/bin/python3","logger":"cosmos.cache"}
{"timestamp":"2025-05-08T08:38:27.666187","level":"warning","event":"The dbt project folder contains a symbolic link to a non-existent file: /opt/airflow/dags/dbt/.venv/bin/python3.13","logger":"cosmos.cache"}
{"timestamp":"2025-05-08T08:39:16.975338","level":"info","event":"Cosmos performance: time to calculate cache identifier cosmos_cache__my_first_dag for current version: 50.98673552200489","logger":"cosmos.cache"}
{"timestamp":"2025-05-08T08:39:16.978355","level":"info","event":"Cosmos performance [81b6b32c5700|380]: The cache size for cosmos_cache__my_first_dag is 2453","logger":"cosmos.dbt.graph"}
{"timestamp":"2025-05-08T08:39:16.979908","level":"info","event":"Cosmos performance: Cache hit for cosmos_cache__my_first_dag - ee3e89bc51bd781e21431365e7002704,1216c01535c4629822fc8b4e59102553","logger":"cosmos.dbt.graph"}
{"timestamp":"2025-05-08T08:39:17.007203","level":"info","event":"Total nodes: 2","logger":"cosmos.dbt.graph"}
{"timestamp":"2025-05-08T08:39:17.007362","level":"info","event":"Total filtered nodes: 2","logger":"cosmos.dbt.graph"}
{"timestamp":"2025-05-08T08:39:17.007554","level":"info","event":"Cosmos performance (my_first_dag) -  [81b6b32c5700|380]: It took 51.1s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE","logger":"cosmos.converter"}
{"timestamp":"2025-05-08T08:39:17.047124","level":"info","event":"Cosmos performance (my_first_dag) - [81b6b32c5700|380]: It took 0.039s to build the Airflow DAG.","logger":"cosmos.converter"}
{"timestamp":"2025-05-08T08:39:17.055722","level":"warning","event":"/home/airflow/.local/lib/python3.12/site-packages/pydantic/main.py:463: UserWarning: Pydantic serializer warnings:\n  PydanticSerializationUnexpectedValue(Expected `str` - serialized value may not be as expected [input_value={'version': 'ee3e89bc51bd..., 'task_group_id': None}, input_type=dict])\n  return self.__pydantic_serializer__.to_python(\n","logger":"py.warnings"}
{"timestamp":"2025-05-08T08:39:17.292194Z","level":"info","event":"Task instance is in running state","chan":"stdout","logger":"task"}
{"timestamp":"2025-05-08T08:39:17.293934Z","level":"info","event":" Previous state of the Task instance: queued","chan":"stdout","logger":"task"}
{"timestamp":"2025-05-08T08:39:17.298359Z","level":"info","event":"Current task name:stg_flights__aircrafts.run","chan":"stdout","logger":"task"}
{"timestamp":"2025-05-08T08:39:17.312425Z","level":"info","event":"Dag name:my_first_dag","chan":"stdout","logger":"task"}
{"timestamp":"2025-05-08T08:39:20.660528","level":"info","event":"dbtRunner is available. Using dbtRunner for invoking dbt.","logger":"cosmos.operators.base"}
{"timestamp":"2025-05-08T08:39:20.666512","level":"info","event":"Cloning project to writable temp directory /tmp/tmp3qcpwl7f from /opt/airflow/dags/dbt","logger":"cosmos.operators.base"}
{"timestamp":"2025-05-08T08:39:20.684424","level":"info","event":"Partial parse is enabled and the latest partial parse file is /opt/airflow/dags/dbt/target/partial_parse.msgpack","logger":"cosmos.operators.base"}
{"timestamp":"2025-05-08T08:39:20.810272","level":"info","event":"Profile caching is enable.","logger":"cosmos.config"}
{"timestamp":"2025-05-08T08:39:20.815000","level":"info","event":"Secrets backends loaded for worker","count":1,"backend_classes":["EnvironmentVariablesBackend"],"logger":"supervisor"}
{"timestamp":"2025-05-08T08:39:20.948548","level":"info","event":"Connection Retrieved 'postgres_dbt'","logger":"airflow.hooks.base"}
{"timestamp":"2025-05-08T08:39:20.950420","level":"info","event":"Using real values for profile default","logger":"cosmos.profiles.base"}
{"timestamp":"2025-05-08T08:39:20.956104","level":"info","event":"Profile not found in cache storing and using profile: /tmp/cosmos/profile/5685f440b338e3a65841a90df244eacf377566740ec75f4ce3e77a914c55ffdd/profiles.yml.","logger":"cosmos.config"}
{"timestamp":"2025-05-08T08:39:20.972574","level":"info","event":"Trying to run dbtRunner with:\n ['deps', '--project-dir', '/tmp/tmp3qcpwl7f', '--profiles-dir', '/tmp/cosmos/profile/5685f440b338e3a65841a90df244eacf377566740ec75f4ce3e77a914c55ffdd', '--profile', 'default', '--target', 'dev']\n in /tmp/tmp3qcpwl7f","logger":"cosmos.dbt.runner"}
{"timestamp":"2025-05-08T08:39:21.221399Z","level":"info","event":"\u001b[0m08:39:21  Running with dbt=1.8.7","chan":"stdout","logger":"task"}
{"timestamp":"2025-05-08T08:39:23.061976Z","level":"info","event":"\u001b[0m08:39:23  Installing dbt-labs/dbt_utils","chan":"stdout","logger":"task"}
{"timestamp":"2025-05-08T08:39:23.737593Z","level":"info","event":"\u001b[0m08:39:23  Installed from version 1.3.0","chan":"stdout","logger":"task"}
{"timestamp":"2025-05-08T08:39:23.741462Z","level":"info","event":"\u001b[0m08:39:23  Up to date!","chan":"stdout","logger":"task"}
{"timestamp":"2025-05-08T08:39:23.744675Z","level":"info","event":"\u001b[0m08:39:23  Installing dbt-labs/codegen","chan":"stdout","logger":"task"}
{"timestamp":"2025-05-08T08:39:24.258012Z","level":"info","event":"\u001b[0m08:39:24  Installed from version 0.13.1","chan":"stdout","logger":"task"}
{"timestamp":"2025-05-08T08:39:24.260074Z","level":"info","event":"\u001b[0m08:39:24  Up to date!","chan":"stdout","logger":"task"}
{"timestamp":"2025-05-08T08:39:24.263198Z","level":"info","event":"\u001b[0m08:39:24  Installing Datavault-UK/automate_dv","chan":"stdout","logger":"task"}
{"timestamp":"2025-05-08T08:39:24.782239Z","level":"info","event":"\u001b[0m08:39:24  Installed from version 0.11.2","chan":"stdout","logger":"task"}
{"timestamp":"2025-05-08T08:39:24.785481Z","level":"info","event":"\u001b[0m08:39:24  Up to date!","chan":"stdout","logger":"task"}
{"timestamp":"2025-05-08T08:39:25.712742","level":"info","event":"Trying to run dbtRunner with:\n ['run', '--models', 'stg_flights__aircrafts', '--project-dir', '/tmp/tmp3qcpwl7f', '--profiles-dir', '/tmp/cosmos/profile/5685f440b338e3a65841a90df244eacf377566740ec75f4ce3e77a914c55ffdd', '--profile', 'default', '--target', 'dev']\n in /tmp/tmp3qcpwl7f","logger":"cosmos.dbt.runner"}
{"timestamp":"2025-05-08T08:39:25.782009Z","level":"info","event":"\u001b[0m08:39:25  Running with dbt=1.8.7","chan":"stdout","logger":"task"}
{"timestamp":"2025-05-08T08:39:26.042476Z","level":"info","event":"\u001b[0m08:39:26  Registered adapter: postgres=1.9.0","chan":"stdout","logger":"task"}
{"timestamp":"2025-05-08T08:39:27.547027Z","level":"info","event":"\u001b[0m08:39:27  Unable to do partial parsing because of a version mismatch","chan":"stdout","logger":"task"}
{"timestamp":"2025-05-08T08:39:32.865064Z","level":"info","event":"\u001b[0m08:39:32  08:39:32 + my pretty message","chan":"stdout","logger":"task"}
{"timestamp":"2025-05-08T08:39:34.176552Z","level":"info","event":"\u001b[0m08:39:34  [\u001b[33mWARNING\u001b[0m]: Deprecated functionality","chan":"stdout","logger":"task"}
{"timestamp":"2025-05-08T08:39:34.179010Z","level":"info","event":"The `tests` config has been renamed to `data_tests`. Please see","chan":"stdout","logger":"task"}
{"timestamp":"2025-05-08T08:39:34.180246Z","level":"info","event":"https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more","chan":"stdout","logger":"task"}
{"timestamp":"2025-05-08T08:39:34.182770Z","level":"info","event":"information.","chan":"stdout","logger":"task"}
{"timestamp":"2025-05-08T08:39:34.794536Z","level":"info","event":"\u001b[0m08:39:34  Found 24 models, 5 snapshots, 10 analyses, 26 data tests, 3 seeds, 1 operation, 8 sources, 850 macros","chan":"stdout","logger":"task"}
{"timestamp":"2025-05-08T08:39:34.798043Z","level":"info","event":"\u001b[0m08:39:34","chan":"stdout","logger":"task"}
{"timestamp":"2025-05-08T08:39:34.976539Z","level":"info","event":"\u001b[0m08:39:34  Concurrency: 1 threads (target='dev')","chan":"stdout","logger":"task"}
{"timestamp":"2025-05-08T08:39:34.980855Z","level":"info","event":"\u001b[0m08:39:34","chan":"stdout","logger":"task"}
{"timestamp":"2025-05-08T08:39:34.983962Z","level":"info","event":"\u001b[0m08:39:34  1 of 1 START sql table model intermediate.stg_flights__aircrafts ............... [RUN]","chan":"stdout","logger":"task"}
{"timestamp":"2025-05-08T08:39:35.155428Z","level":"info","event":"\u001b[0m08:39:35  1 of 1 ERROR creating sql table model intermediate.stg_flights__aircrafts ...... [\u001b[31mERROR\u001b[0m in 0.17s]","chan":"stdout","logger":"task"}
{"timestamp":"2025-05-08T08:39:35.171199Z","level":"info","event":"\u001b[0m08:39:35","chan":"stdout","logger":"task"}
{"timestamp":"2025-05-08T08:39:35.173462Z","level":"info","event":"\u001b[0m08:39:35  Running 1 on-run-end hook","chan":"stdout","logger":"task"}
{"timestamp":"2025-05-08T08:39:35.183321Z","level":"info","event":"\u001b[0m08:39:35  1 of 1 START hook: dbt_course_practice.on-run-end.0 ............................ [RUN]","chan":"stdout","logger":"task"}
{"timestamp":"2025-05-08T08:39:35.186644Z","level":"info","event":"\u001b[0m08:39:35  1 of 1 OK hook: dbt_course_practice.on-run-end.0 ............................... [\u001b[32mOK\u001b[0m in 0.00s]","chan":"stdout","logger":"task"}
{"timestamp":"2025-05-08T08:39:35.190301Z","level":"info","event":"\u001b[0m08:39:35","chan":"stdout","logger":"task"}
{"timestamp":"2025-05-08T08:39:35.191079Z","level":"info","event":"\u001b[0m08:39:35","chan":"stdout","logger":"task"}
{"timestamp":"2025-05-08T08:39:35.192494Z","level":"info","event":"\u001b[0m08:39:35  Finished running 1 table model, 1 project hook in 0 hours 0 minutes and 0.39 seconds (0.39s).","chan":"stdout","logger":"task"}
{"timestamp":"2025-05-08T08:39:35.237717Z","level":"info","event":"\u001b[0m08:39:35","chan":"stdout","logger":"task"}
{"timestamp":"2025-05-08T08:39:35.241883Z","level":"info","event":"\u001b[0m08:39:35  \u001b[31mCompleted with 1 error and 0 warnings:\u001b[0m","chan":"stdout","logger":"task"}
{"timestamp":"2025-05-08T08:39:35.246779Z","level":"info","event":"\u001b[0m08:39:35","chan":"stdout","logger":"task"}
{"timestamp":"2025-05-08T08:39:35.251236Z","level":"info","event":"\u001b[0m08:39:35    Database Error in model stg_flights__aircrafts (models/staging/flights/stg_flights__aircrafts.sql)","chan":"stdout","logger":"task"}
{"timestamp":"2025-05-08T08:39:35.261976Z","level":"info","event":"  relation \"stg_flights__aircrafts__dbt_backup\" already exists","chan":"stdout","logger":"task"}
{"timestamp":"2025-05-08T08:39:35.265169Z","level":"info","event":"  compiled code at target/run/dbt_course_practice/models/staging/flights/stg_flights__aircrafts.sql","chan":"stdout","logger":"task"}
{"timestamp":"2025-05-08T08:39:35.267082Z","level":"info","event":"\u001b[0m08:39:35","chan":"stdout","logger":"task"}
{"timestamp":"2025-05-08T08:39:35.274038Z","level":"info","event":"\u001b[0m08:39:35  Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1","chan":"stdout","logger":"task"}
{"timestamp":"2025-05-08T08:39:36.433460","level":"info","event":"Inlets: []","logger":"cosmos.operators.base"}
{"timestamp":"2025-05-08T08:39:36.433892","level":"info","event":"Outlets: []","logger":"cosmos.operators.base"}
{"timestamp":"2025-05-08T08:39:36.434252","level":"info","event":"Assigning outlets with DatasetAlias in Airflow 3","logger":"cosmos.operators.local"}
{"timestamp":"2025-05-08T08:39:36.486576","level":"error","event":"Task failed with exception","logger":"task","error_detail":[{"exc_type":"CosmosDbtRunError","exc_value":"dbt invocation completed with errors: stg_flights__aircrafts: Database Error in model stg_flights__aircrafts (models/staging/flights/stg_flights__aircrafts.sql)\n  relation \"stg_flights__aircrafts__dbt_backup\" already exists\n  compiled code at target/run/dbt_course_practice/models/staging/flights/stg_flights__aircrafts.sql","exc_notes":[],"syntax_error":null,"is_cause":false,"frames":[{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":825,"name":"run"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":1088,"name":"_execute_task"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/cosmos/operators/base.py","lineno":310,"name":"execute"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/cosmos/operators/local.py","lineno":790,"name":"build_and_run_cmd"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/cosmos/operators/local.py","lineno":594,"name":"run_command"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/cosmos/operators/local.py","lineno":244,"name":"handle_exception_dbt_runner"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/cosmos/dbt/runner.py","lineno":113,"name":"handle_exception_if_needed"}]}]}
{"timestamp":"2025-05-08T08:39:36.633751Z","level":"info","event":"Task instance in failure state","chan":"stdout","logger":"task"}
{"timestamp":"2025-05-08T08:39:36.635286Z","level":"info","event":"Task start","chan":"stdout","logger":"task"}
{"timestamp":"2025-05-08T08:39:36.637200Z","level":"info","event":"Task:<Task(DbtRunLocalOperator): stg_flights__aircrafts.run>","chan":"stdout","logger":"task"}
{"timestamp":"2025-05-08T08:39:36.638181Z","level":"info","event":"Failure caused by dbt invocation completed with errors: stg_flights__aircrafts: Database Error in model stg_flights__aircrafts (models/staging/flights/stg_flights__aircrafts.sql)","chan":"stdout","logger":"task"}
{"timestamp":"2025-05-08T08:39:36.638796Z","level":"info","event":"  relation \"stg_flights__aircrafts__dbt_backup\" already exists","chan":"stdout","logger":"task"}
{"timestamp":"2025-05-08T08:39:36.639376Z","level":"info","event":"  compiled code at target/run/dbt_course_practice/models/staging/flights/stg_flights__aircrafts.sql","chan":"stdout","logger":"task"}
{"timestamp":"2025-05-08T08:39:36.640062Z","level":"error","event":"/usr/local/lib/python3.12/multiprocessing/resource_tracker.py:279: UserWarning: resource_tracker: There appear to be 2 leaked semaphore objects to clean up at shutdown","chan":"stderr","logger":"task"}
{"timestamp":"2025-05-08T08:39:36.640540Z","level":"error","event":"  warnings.warn('resource_tracker: There appear to be %d '","chan":"stderr","logger":"task"}
